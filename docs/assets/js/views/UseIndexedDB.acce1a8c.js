import{h as e,i as s,b as a}from"../element-plus/element-plus.cb05fe15.js";import{a as t}from"../animejs/animejs.9d778250.js";import{l}from"../lodash/lodash.49a774dc.js";import{l as i}from"../localforage/localforage.e647ef54.js";import{C as o,r,c as n,a4 as u,a as c,S as p,Q as m,L as d,M as f,a3 as v,o as g,U as h,af as j,ag as y,aj as x}from"../@vue/@vue.fedea094.js";import{_ as w}from"../../index-9304b55b.js";import"../dayjs/dayjs.341dffa3.js";import"../@element-plus/@element-plus.b2370078.js";import"../lodash-es/lodash-es.9c91e0f2.js";import"../@vueuse/@vueuse.0f7aa3eb.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../autofit.js/autofit.js.7791d2f0.js";import"../vue-router/vue-router.165ab965.js";import"../echarts/echarts.6b41119b.js";import"../zrender/zrender.ec62154b.js";import"../tslib/tslib.a4e99503.js";const I=""+new URL("../../file-44ac38b1.svg",import.meta.url).href,L=""+new URL("../../success-dd03ce08.svg",import.meta.url).href,_=i.createInstance({name:"LocalData"});function b(s){const{message:a,type:t="info",duration:l=2e3}=s;e({message:a,type:t,duration:l})}_.config({driver:i.INDEXEDDB});const k=e=>(j("data-v-8fe1feb4"),e=e(),y(),e),D={id:"use-indexDB"},B=k((()=>c("br",null,null,-1))),U={class:"file-list"},z={key:0},C=[k((()=>c("p",null,"暂无文件",-1)))],E=k((()=>c("img",{src:I,alt:"file"},null,-1))),M=["onClick"],R=[k((()=>c("path",{d:"M720.298667 768c-12.714667 0-23.850667-4.778667-33.408-14.293333L270.293333 337.066667c-19.072-19.114667-19.072-49.322667 0-66.816 19.114667-19.072 49.322667-19.072 66.816 0l416.597334 415.018666c19.072 19.072 19.072 49.28 0 66.773334-9.557333 11.136-22.272 15.914667-33.408 15.914666z",fill:"var(--icon-del)","p-id":"7130"},null,-1))),k((()=>c("path",{d:"M303.701333 768c-12.714667 0-23.850667-4.778667-33.408-14.293333-19.072-19.114667-19.072-49.322667 0-66.816l415.018667-416.597334c19.072-19.072 49.28-19.072 66.773333 0 19.114667 19.114667 19.114667 49.322667 0 66.816l-414.976 416.597334a45.781333 45.781333 0 0 1-33.408 14.293333z",fill:"var(--icon-del)","p-id":"7131"},null,-1)))],S=k((()=>c("img",{class:"icon-success",src:L,alt:"√"},null,-1))),q=w(o({__name:"UseIndexedDB",setup(e){const i=r(),o=r([]);_.getItem("fileList").then((e=>{e&&e.forEach((e=>{o.value.push(e)}))}));const j=(e,s)=>{s.findIndex((s=>s.name===e.name))!==l.findLastIndex(s,(s=>s.name===e.name))&&(s.pop(),b({message:"文件重复，已取消该文件此次上传",type:"warning"})),o.value=s},y=()=>{const e=[];o.value.forEach((s=>{e.push(x(s))})),_.setItem("fileList",e).then((()=>{b({message:"文件上传成功！",type:"success"})})).catch((()=>{b({message:"文件上传失败！",type:"error"})}))};return(e,l)=>{const r=a,x=s;return g(),n("div",D,[u(" IndexedDB "),B,c("div",U,[p(x,{style:{"margin-bottom":"8px"},ref_key:"uploadRef",ref:i,"file-list":o.value,"onUpdate:fileList":l[0]||(l[0]=e=>o.value=e),action:"",multiple:"","auto-upload":!1,"show-file-list":!1,"on-change":j},{trigger:m((()=>[p(r,{type:"primary"},{default:m((()=>[u("选择文件")])),_:1})])),default:m((()=>[p(r,{type:"success",style:{"margin-left":"12px"},onClick:y},{default:m((()=>[u("点击上传文件")])),_:1})])),_:1},8,["file-list"]),0===o.value.length?(g(),n("div",z,C)):d("",!0),(g(!0),n(f,null,v(o.value,(e=>(g(),n("div",{key:e.uid,class:"file-list-main"},[E,c("span",null,h(e.name),1),(g(),n("svg",{class:"icon-del",onClick:s=>(e=>{const s=o.value.findIndex((s=>s.uid===e.uid)),a=document.querySelectorAll(".file-list-main")[s];t({targets:a,translateY:-a.clientHeight,opacity:0,complete:()=>{o.value=o.value.filter((s=>s.uid!==e.uid))}})})(e),t:"1693400162714",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7129",width:"200",height:"200"},R,8,M)),S])))),128))])])}}}),[["__scopeId","data-v-8fe1feb4"]]);export{q as default};
